// util.js
var oauth   = require("oauth")
var error   = require("./error.js")

this.oauth = new oauth.OAuth2(
			process.env.cId, process.env.cKey,
			'https://twinoid.com/', 'oauth/auth', 'oauth/token', null
		)

this.need = { 
	auth: function auth(req, res, next){
		if(!req.session) 
			return next(new Error("Something is wrong with the session."))
		if(!req.session.uid) 
			return next(new error.Unauthorized("login required"))
		next()
	}
}
